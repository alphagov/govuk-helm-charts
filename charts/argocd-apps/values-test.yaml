globalHelmValues:
  govukEnvironment: test
  govukStack: pink  # TODO: eliminate the need for govukStack
  externalDomainSuffix: eks.test.govuk.digital

applications:
- name: argo-workflows
  chartPath: charts/argo-workflows
- name: cluster-secrets
  chartPath: charts/cluster-secrets
- name: govuk-apps-conf
  chartPath: charts/govuk-apps-conf
- name: smokey
  chartPath: charts/smokey
- name: publisher
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/publisher
      tag: latest  # To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    workerEnabled: true
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: publisher
      hosts:
      - name: publisher.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv:
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-publisher-eks
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-publisher-eks
            key: oauth_secret
      - name: ASSET_MANAGER_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-asset-manager
            key: bearer_token
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-publishing-api
            key: bearer_token
      - name: FACT_CHECK_USERNAME
        valueFrom:
          secretKeyRef:
            name: publisher-fact-check-email-account
            key: FACT_CHECK_USERNAME
      - name: FACT_CHECK_PASSWORD
        valueFrom:
          secretKeyRef:
            name: publisher-fact-check-email-account
            key: FACT_CHECK_PASSWORD
      - name: GOVUK_NOTIFY_API_KEY
        valueFrom:
          secretKeyRef:
            name: publisher-notify
            key: GOVUK_NOTIFY_API_KEY
      - name: JWT_AUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: authenticating-proxy-jwt-auth-secret
            key: JWT_AUTH_SECRET
      - name: LINK_CHECKER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-link-checker-api
            key: bearer_token
      - name: LINK_CHECKER_API_SECRET_TOKEN
        valueFrom:
          secretKeyRef:
            name: publisher-link-checker-api-callback-token
            key: LINK_CHECKER_API_SECRET_TOKEN
      - name: MONGODB_URI
        valueFrom:
          secretKeyRef:
            name: publisher-docdb
            key: MONGODB_URI
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: EMAIL_GROUP_BUSINESS
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_CITIZEN
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_DEV
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_FORCE_PUBLISH_ALERTS
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: FACT_CHECK_ADDRESS_FORMAT
        value: factcheck+test-{id}@alphagov.co.uk
      - name: FACT_CHECK_SUBJECT_PREFIX
        value: test
      - name: FACT_CHECK_REPLY_TO_ADDRESS
        value: govuk-fact-check-test@digital.cabinet-office.gov.uk
      - name: FACT_CHECK_REPLY_TO_ID
        value: govuk-fact-check-test@digital.cabinet-office.gov.uk
      - name: GOVUK_NOTIFY_TEMPLATE_ID
        value: 123e4567-e89b-12d3-a456-426614174000
- name: signon
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/signon
      tag: latest  # To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    workerEnabled: true
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: signon
      hosts:
      - name: signon.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv:
      - name: DEVISE_PEPPER
        value: secret
      - name: DEVISE_SECRET_KEY
        value: secret
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: PORT
        value: "3000"
      - name: GOVUK_CONTENT_SCHEMAS_PATH
        value: /govuk-content-schemas
      - name: DEFAULT_TTL
        value: "1800"
      - name: GOVUK_APP_NAME
        value: signon
      - name: DATABASE_URL
        valueFrom:
          secretKeyRef:
            name: signon
            key: database-url
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: RAILS_ENV
        value: production
      - name: GOVUK_APP_TYPE
        value: rack
      - name: SIGNON_ADMIN_PASSWORD
        valueFrom:
          secretKeyRef:
            name: signon-auth-token
            key: token
- name: router
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/router
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: www-origin
      hosts:
      - name: www-origin.eks.test.govuk.digital
    extraEnv:
      - name: foo  # XXX TODO: finish configuring Router
        value: bar
- name: frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-frontend-publishing-api
            key: bearer_token
      - name: PORT
        value: "3000"
      - name: MEMCACHE_SERVERS
        value: frontend-memcached.eks.test.govuk-internal.digital
- name: static
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/static
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: PORT
        value: "3000"
      - name: RAILS_ENV
        value: production
      - name: DEFAULT_TTL
        value: "1800"
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: GA_UNIVERSAL_ID
        value: UA-26179049-22
      - name: GOVUK_APP_NAME
        value: static
      - name: GOVUK_APP_TYPE
        value: rack
      - name: GOVUK_APP_ROOT
        value: /var/apps/static
- name: content-store
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/content-store
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: ROUTER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-content-store-router-api
            key: bearer_token
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-content-store
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-content-store
            key: oauth_secret
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: PORT
        value: "3000"
      - name: GOVUK_CONTENT_SCHEMAS_PATH
        value: /govuk-content-schemas
      - name: DEFAULT_TTL
        value: "1800"
      - name: MONGODB_URI
        valueFrom:
          secretKeyRef:
            name: content-store-docdb
            key: MONGODB_URI
      - name: GOVUK_APP_NAME
        value: content-store
- name: signon-resources
  chartPath: charts/signon-resources
  helmValues:
    image:
      tag: 0.0.14
- name: info-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/info-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: GOVUK_APP_DOMAIN
        value: www.gov.uk
      - name: GOVUK_WEBSITE_ROOT
        value: https://www.gov.uk
      - name: GOVUK_APP_NAME
        value: info-frontend
- name: finder-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/finder-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: GOVUK_APP_DOMAIN
        value: www.gov.uk
      - name: GOVUK_WEBSITE_ROOT
        value: https://www.gov.uk
      - name: GOVUK_APP_NAME
        value: finder-frontend
- name: collections
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/collections
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        value: secret  # TODO: set SECRET_KEY_BASE and make it a secret
      - name: GOVUK_APP_NAME
        value: collections
- name: government-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/government-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: GOVUK_APP_DOMAIN
        value: www.gov.uk
      - name: GOVUK_WEBSITE_ROOT
        value: https://www.gov.uk
      - name: GOVUK_APP_NAME
        value: government-frontend
