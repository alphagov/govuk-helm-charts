globalHelmValues:
  govukEnvironment: test
  govukStack: pink  # TODO: eliminate the need for govukStack
  externalDomainSuffix: eks.test.govuk.digital
  publishingServiceDomainSuffix: test.publishing.service.gov.uk

applications:
- name: argo-workflows
  chartPath: charts/argo-workflows
- name: cluster-secrets
  chartPath: charts/cluster-secrets
- name: govuk-apps-conf
  chartPath: charts/govuk-apps-conf
- name: smokey
  chartPath: charts/smokey
- name: publisher
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/publisher
      tag: latest  # To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    workerEnabled: true
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: publisher
      hosts:
      - name: publisher.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv:
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-publisher-eks
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-publisher-eks
            key: oauth_secret
      - name: ASSET_MANAGER_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-asset-manager
            key: bearer_token
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-publishing-api
            key: bearer_token
      - name: FACT_CHECK_USERNAME
        valueFrom:
          secretKeyRef:
            name: publisher-fact-check-email-account
            key: FACT_CHECK_USERNAME
      - name: FACT_CHECK_PASSWORD
        valueFrom:
          secretKeyRef:
            name: publisher-fact-check-email-account
            key: FACT_CHECK_PASSWORD
      - name: GOVUK_NOTIFY_API_KEY
        valueFrom:
          secretKeyRef:
            name: publisher-notify
            key: GOVUK_NOTIFY_API_KEY
      - name: JWT_AUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: authenticating-proxy-jwt-auth-secret
            key: JWT_AUTH_SECRET
      - name: LINK_CHECKER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publisher-link-checker-api
            key: bearer_token
      - name: LINK_CHECKER_API_SECRET_TOKEN
        valueFrom:
          secretKeyRef:
            name: publisher-link-checker-api-callback-token
            key: LINK_CHECKER_API_SECRET_TOKEN
      - name: MONGODB_URI
        valueFrom:
          secretKeyRef:
            name: publisher-docdb
            key: MONGODB_URI
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: EMAIL_GROUP_BUSINESS
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_CITIZEN
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_DEV
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: EMAIL_GROUP_FORCE_PUBLISH_ALERTS
        value: mainstream-publisher-notifications-test@digital.cabinet-office.gov.uk
      - name: FACT_CHECK_ADDRESS_FORMAT
        value: factcheck+test-{id}@alphagov.co.uk
      - name: FACT_CHECK_SUBJECT_PREFIX
        value: test
      - name: FACT_CHECK_REPLY_TO_ADDRESS
        value: govuk-fact-check-test@digital.cabinet-office.gov.uk
      - name: FACT_CHECK_REPLY_TO_ID
        value: govuk-fact-check-test@digital.cabinet-office.gov.uk
      - name: GOVUK_NOTIFY_TEMPLATE_ID
        value: 123e4567-e89b-12d3-a456-426614174000
- name: publishing-api
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/publishing-api
      tag: latest  # To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    uploadAssets:
      enabled: false
    workerEnabled: true
    replicaCount: 1
    workerReplicaCount: 1
    appProbes:
      livenessProbe:
        exec:
          command:
          - "true"
        initialDelaySeconds: 10
        failureThreshold: 100
        periodSeconds: 10
        timeoutSeconds: 900
    appResources:
      limits:
        cpu: 1
        memory: 2Gi
      requests:
        cpu: 1
        memory: 2Gi
    extraEnv:
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-publishing-api
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-publishing-api
            key: oauth_secret
      - name: CONTENT_STORE_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publishing-api-content-store
            key: bearer_token
      - name: DRAFT_CONTENT_STORE_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publishing-api-draft-content-store
            key: bearer_token
      - name: ROUTER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publishing-api-router-api
            key: bearer_token
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: RABBITMQ_HOSTS
        value: rabbitmq.test.govuk-internal.digital
      - name: RABBITMQ_PASSWORD
        valueFrom:
          secretKeyRef:
            name: publishing-api-rabbitmq
            key: password
      - name: RABBITMQ_USER
        value: publishing_api
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: EVENT_LOG_AWS_BUCKETNAME
        value: govuk-publishing-api-event-log-test
      - name: EVENT_LOG_AWS_ACCESS_ID
        value: unset  # TODO: Set up Event Log S3 Bucket (not in terraform)
      - name: EVENT_LOG_AWS_SECRET_KEY
        value: unset  # TODO: Set up Event Log S3 Bucket (not in terraform)
      - name: EVENT_LOG_AWS_USERNAME
        value: govuk-publishing-api-event-log_user
      - name: GOVUK_CONTENT_SCHEMAS_PATH
        value: /govuk-content-schemas
      - name: SENTRY_DSN
        valueFrom:
          secretKeyRef:
            name: publishing-api-sentry-dsn
            key: dsn
      - name: DATABASE_URL
        valueFrom:
          secretKeyRef:
            name: publishing-api-database-url-ec2
            key: DATABASE_URL
- name: signon
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/signon
      tag: latest  # To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    workerEnabled: true
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: signon
      hosts:
      - name: signon.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv:
      - name: DEVISE_PEPPER
        value: secret
      - name: DEVISE_SECRET_KEY
        value: secret
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: DATABASE_URL
        valueFrom:
          secretKeyRef:
            name: signon-mysql
            key: DATABASE_URL
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: SIGNON_ADMIN_PASSWORD
        valueFrom:
          secretKeyRef:
            name: signon-auth-token
            key: token
- name: router
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/router
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    uploadAssets:
      enabled: false
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: www-origin
      hosts:
      - name: www-origin.eks.test.govuk.digital
    nginxConfigMap:
      create: false
      name: router-nginx-conf
    nginxExtraVolumeMounts:
      - name: router-nginx-conf
        mountPath: /usr/share/nginx/html/robots.txt
        subPath: robots.txt
      - name: router-nginx-htpasswd
        mountPath: /etc/nginx/htpasswd
    nginxExtraVolumes:
      - name: router-nginx-htpasswd
        secret:
          secretName: router-nginx-htpasswd
    nginxImage: &router-nginx-image
      tag: stable-perl
      pullPolicy: Always
    appProbes: &router-app-probes
      startupProbe: &router-probe
        httpGet:
          path: /healthcheck
          port: 3001
        failureThreshold: 10
        periodSeconds: 1
        timeoutSeconds: 1
      livenessProbe:
        <<: *router-probe
        failureThreshold: 3
        periodSeconds: 5
      readinessProbe:
        <<: *router-probe
        httpGet:
          path: /healthcheck
          port: 3001
        failureThreshold: 2
        periodSeconds: 5
    appResources:
      limits:
        cpu: 1
        memory: 1.5Gi
      requests:
        cpu: 500m
        memory: 1Gi
    extraEnv:
      - name: ROUTER_PUBADDR
        value: ":3000"
      - name: ROUTER_APIADDR
        value: ":3001"
      - name: ROUTER_MONGO_URL
        value: &router_mongo_hosts "\
          router-backend-1.pink.test.govuk-internal.digital,\
          router-backend-2.pink.test.govuk-internal.digital,\
          router-backend-3.pink.test.govuk-internal.digital"
      - name: BACKEND_URL_collections
        value: "http://collections"
      - name: BACKEND_URL_content-store
        value: "http://content-store"
      - name: BACKEND_URL_email-alert-frontend
        value: "http://email-alert-frontend"
      - name: BACKEND_URL_frontend
        value: "http://frontend"
      - name: BACKEND_URL_government-frontend
        value: "http://government-frontend"
      - name: BACKEND_URL_manuals-frontend
        value: "http://manuals-frontend"
      - name: BACKEND_URL_service-manual-frontend
        value: "http://service-manual-frontend"
      - name: BACKEND_URL_smartanswers
        value: "http://smartanswers"
      - name: BACKEND_URL_static
        value: "http://static"
      - name: BACKEND_URL_whitehall-frontend
        value: "http://whitehall-frontend"
      - name: BACKEND_URL_account-api
        value: "http://account-api"
      - name: BACKEND_URL_feedback
        value: "http://feedback"
      - name: BACKEND_URL_finder-frontend
        value: "http://finder-frontend"
      - name: BACKEND_URL_info-frontend
        value: "http://info-frontend"
      - name: BACKEND_URL_licencefinder
        value: "http://licencefinder"
      - name: BACKEND_URL_licensify  # There is no Licensify in test.
        value: "https://licensify.integration.publishing.service.gov.uk"
      - name: BACKEND_URL_search-api
        value: "http://search-api"
- name: draft-router
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/router
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    uploadAssets:
      enabled: false
    nginxImage: *router-nginx-image
    appProbes: *router-app-probes
    appResources:
      limits:
        cpu: 1
        memory: 1.5Gi
      requests:
        cpu: 500m
        memory: 1Gi
    extraEnv:
      - name: ROUTER_PUBADDR
        value: ":3000"
      - name: ROUTER_APIADDR
        value: ":3001"
      - name: ROUTER_MONGO_URL
        value: *router_mongo_hosts
      - name: ROUTER_MONGO_DB
        value: draft_router
      - name: BACKEND_URL_collections
        value: "http://draft-collections"
      - name: BACKEND_URL_content-store
        value: "http://draft-content-store"
      - name: BACKEND_URL_email-alert-frontend
        value: "http://draft-email-alert-frontend"
      - name: BACKEND_URL_frontend
        value: "http://draft-frontend"
      - name: BACKEND_URL_government-frontend
        value: "http://draft-government-frontend"
      - name: BACKEND_URL_manuals-frontend
        value: "http://draft-manuals-frontend"
      - name: BACKEND_URL_service-manual-frontend
        value: "http://draft-service-manual-frontend"
      - name: BACKEND_URL_smartanswers
        value: "http://draft-smartanswers"
      - name: BACKEND_URL_static
        value: "http://draft-static"
      - name: BACKEND_URL_whitehall-frontend
        value: "http://draft-whitehall-frontend"
      - name: BACKEND_URL_account-api
        value: "http://account-api"
      - name: BACKEND_URL_feedback
        value: "http://feedback"
      - name: BACKEND_URL_finder-frontend
        value: "http://finder-frontend"
      - name: BACKEND_URL_info-frontend
        value: "http://info-frontend"
      - name: BACKEND_URL_licencefinder
        value: "http://licencefinder"
      - name: BACKEND_URL_licensify  # There is no Licensify in test.
        value: "https://licensify.integration.publishing.service.gov.uk"
      - name: BACKEND_URL_search-api
        value: "http://search-api"
- name: authenticating-proxy
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/authenticating-proxy
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: draft-origin
      hosts:
      - name: draft-origin.eks.test.govuk.digital
    dnsConfig:  # TODO: remove dnsConfig once MongoDB migrated to DocDB.
      searches:
        - pink.test.govuk-internal.digital
    uploadAssets:
      enabled: false
    extraEnv:
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-authenticating-proxy
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-authenticating-proxy
            key: oauth_secret
      - name: GOVUK_UPSTREAM_URI
        value: "http://draft-router"
      - name: JWT_AUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: authenticating-proxy-jwt-auth-secret
            key: JWT_AUTH_SECRET
      - name: MONGODB_URI  # TODO: this will need to become a secret when moving to DocDB.
        value: "mongodb://\
          router-backend-1,\
          router-backend-2,\
          router-backend-3/authenticating_proxy_production"
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-frontend-publishing-api
            key: bearer_token
      - name: MEMCACHE_SERVERS
        value: frontend-memcached-govuk.eks.test.govuk-internal.digital
- name: static
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/static
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: GA_UNIVERSAL_ID
        value: UA-26179049-22
      - name: GOVUK_APP_ROOT
        value: /var/apps/static
- name: content-store
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/content-store
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: ROUTER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-content-store-router-api
            key: bearer_token
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-content-store
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-content-store
            key: oauth_secret
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: DEFAULT_TTL
        value: "1800"
      - name: MONGODB_URI
        valueFrom:
          secretKeyRef:
            name: content-store-docdb
            key: MONGODB_URI
- name: signon-resources
  chartPath: charts/signon-resources
  helmValues:
    image:
      tag: 0.0.14
- name: info-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/info-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: finder-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/finder-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: EMAIL_ALERT_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-finder-frontend-email-alert-api
            key: bearer_token
- name: collections
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/collections
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: whitehall-admin
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/whitehall
      tag: f01a5161aa0d93b2efdd0775c61081695f12447a  # TODO: To be edited by automation (not yet implemented).
    dbMigrationEnabled: true
    workerEnabled: true
    uploadAssets: &whitehall-upload-assets
      path: "/app/public/assets/whitehall"
      s3Directory: "whitehall"
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: whitehall-admin
      hosts:
      - name: whitehall-admin.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv: &whitehall-envs
      - name: NODE_ENV
        value: production
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-whitehall
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-whitehall
            key: oauth_secret
      - name: ASSET_MANAGER_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-whitehall-asset-manager
            key: bearer_token
      - name: GOVUK_NOTIFY_API_KEY
        valueFrom:
          secretKeyRef:
            name: publisher-notify
            key: GOVUK_NOTIFY_API_KEY
      - name: JWT_AUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: authenticating-proxy-jwt-auth-secret
            key: JWT_AUTH_SECRET
      - name: LINK_CHECKER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-whitehall-link-checker-api
            key: bearer_token
      - name: LINK_CHECKER_API_SECRET_TOKEN
        valueFrom:
          secretKeyRef:
            name: publisher-link-checker-api-callback-token
            key: LINK_CHECKER_API_SECRET_TOKEN
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-whitehall-publishing-api
            key: bearer_token
      - name: GOVUK_NOTIFY_TEMPLATE_ID
        value: 759acac6-da53-4a19-b591-b7538c7c39de
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: MEMCACHE_SERVERS
        value: frontend-memcached-govuk.eks.test.govuk-internal.digital
      - name: DATABASE_URL
        valueFrom:
          secretKeyRef:
            name: whitehall-mysql
            key: DATABASE_URL
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: whitehall-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/whitehall
      tag: f01a5161aa0d93b2efdd0775c61081695f12447a  # TODO: To be edited by automation (not yet implemented).
    replicaCount: 1
    uploadAssets: *whitehall-upload-assets
    extraEnv: *whitehall-envs
- name: draft-whitehall-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/whitehall
      tag: f01a5161aa0d93b2efdd0775c61081695f12447a  # TODO: To be edited by automation (not yet implemented).
    replicaCount: 1
    uploadAssets: *whitehall-upload-assets
    extraEnv: *whitehall-envs
- name: government-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/government-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: asset-manager
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/asset-manager
      tag: latest  # TODO: To be edited by automation (not yet implemented).
    workerEnabled: true
    ingress:
      enabled: true
      annotations:
        alb.ingress.kubernetes.io/load-balancer-name: asset-manager
      hosts:
      - name: asset-manager.eks.test.govuk.digital
    replicaCount: 1
    workerReplicaCount: 1
    extraEnv:
      - name: ASSET_MANAGER_CLAMSCAN_PATH
        value: /bin/true  # TODO: Clamscan hasn't been tested yet, will update it to correct values after testing
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-asset-manager
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-asset-manager
            key: oauth_secret
      - name: GOVUK_APP_ROOT
        value: /var/apps/static
      - name: GOVUK_STATSD_PREFIX
        value: asset-manager
      - name: JWT_AUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: authenticating-proxy-jwt-auth-secret
            key: JWT_AUTH_SECRET
      - name: MONGODB_URI
        valueFrom:
          secretKeyRef:
            name: asset-manager-docdb
            key: MONGODB_URI
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.test.govuk-internal.digital
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: contacts-admin
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/contacts-admin
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
- name: manuals-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/manuals-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-manuals-frontend-publishing-api
            key: bearer_token
- name: email-alert-frontend
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/email-alert-frontend
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SUBSCRIPTION_MANAGEMENT_ENABLED
        value: "yes"
      - name: REDIS_URL
        value: redis://shared-redis-govuk.eks.integration.govuk-internal.digital
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: ACCOUNT_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-email-alert-frontend-account-api
            key: bearer_token
      - name: EMAIL_ALERT_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-email-alert-frontend-email-alert-api
            key: bearer_token
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-email-alert-frontend-publishing-api
            key: bearer_token
      - name: EMAIL_ALERT_AUTH_TOKEN
        valueFrom:
          secretKeyRef:
            name: email-alert-auth
            key: token
- name: smartanswers
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/smart-answers
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: EXPOSE_GOVSPEAK
        value: "1"
      - name: COMPANIES_HOUSE_API_KEY
        valueFrom:
          secretKeyRef:
            name: smartanswers-companies-house
            key: api_key
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: LINK_CHECKER_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-smartanswers-link-checker-api
            key: bearer_token
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-smartanswers-publishing-api
            key: bearer_token
      - name: ZENDESK_CLIENT_USERNAME
        valueFrom:
          secretKeyRef:
            name: smartanswers-zendesk-client
            key: username
      - name: ZENDESK_CLIENT_PASSWORD
        valueFrom:
          secretKeyRef:
            name: smartanswers-zendesk-client
            key: password
- name: feedback
  helmValues:
    appImage:
      repository: 172025368201.dkr.ecr.eu-west-1.amazonaws.com/feedback
      tag: latest  # To be edited by automation (not yet implemented).
    replicaCount: 1
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: SUPPORT_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-support-bearer-feedback
            key: bearer_token
      - name: SUPPORT_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-support-api-bearer-token-feedback
            key: bearer_token
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-publishing-api-bearer-feedback
            key: bearer_token
      - name: ASSISTED_DIGITAL_GOOGLE_SPREADSHEET_KEY
        valueFrom:
          secretKeyRef:
            name: feedback-assisted-digital-google-sheet
            key: sheet_id
      - name: GOOGLE_CLIENT_EMAIL
        valueFrom:
          secretKeyRef:
            name: feedback-assisted-digital-google-sheet
            key: client_email
      - name: GOOGLE_PRIVATE_KEY
        valueFrom:
          secretKeyRef:
            name: feedback-assisted-digital-google-sheet
            key: private_key
      - name: GOVUK_NOTIFY_API_KEY
        valueFrom:
          secretKeyRef:
            name: feedback-notify
            key: GOVUK_NOTIFY_API_KEY
- name: search-api
  helmValues:
    uploadAssets:
      enabled: false
    replicaCount: 1
    extraEnv:
      - name: AWS_REGION
        value: eu-west-1
      - name: AWS_S3_RELEVANCY_BUCKET_NAME
        value: govuk-integration-search-relevancy
      - name: AWS_S3_SITEMAPS_BUCKET_NAME
        value: govuk-integration-sitemaps
      - name: ELASTICSEARCH_URI
        value: https://vpc-blue-elasticsearch6-domain-uolbxqjhkiqmg5w3gg7gio5sty.eu-west-1.es.amazonaws.com
      - name: ENABLE_LTR
        value: "true"
      - name: GDS_SSO_OAUTH_ID
        valueFrom:
          secretKeyRef:
            name: signon-app-search-api-eks
            key: oauth_id
      - name: GDS_SSO_OAUTH_SECRET
        valueFrom:
          secretKeyRef:
            name: signon-app-search-api-eks
            key: oauth_secret
      - name: GOOGLE_ANALYTICS_GOVUK_VIEW_ID
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: govuk-view-id
      - name: GOOGLE_CLIENT_EMAIL
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: client-email
      - name: GOOGLE_EXPORT_ACCOUNT_ID
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: export-account-id
      - name: GOOGLE_EXPORT_CUSTOM_DATA_SOURCE_ID
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: export-custom-data-source-id
      - name: GOOGLE_EXPORT_WEB_PROPERTY_ID
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: export-web-property-id
      - name: GOOGLE_PRIVATE_KEY
        valueFrom:
          secretKeyRef:
            name: search-api-google-analytics
            key: private-key
      - name: GOOGLE_BIGQUERY_CREDENTIALS
        valueFrom:
          secretKeyRef:
            name: search-api-google-bigquery
            key: credentials
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-search-api-eks-publishing-api
            key: bearer_token
      - name: RABBITMQ_HOSTS
        value: rabbitmq.integration.govuk-internal.digital
      - name: RABBITMQ_VHOST
        value: /
      - name: RABBITMQ_USER
        valueFrom:
          secretKeyRef:
            name: search-api-rabbitmq
            key: user
      - name: RABBITMQ_PASSWORD
        valueFrom:
          secretKeyRef:
            name: search-api-rabbitmq
            key: password
      - name: TENSORFLOW_SAGEMAKER_ENDPOINT
        value: govuk-integration-search-ltr-endpoint
      - name: TENSORFLOW_SAGEMAKER_VARIANTS
        value: null  # value is empty
- name: license-finder
  helmValues:
    replicaCount: 
    extraEnv:
      - name: SECRET_KEY_BASE
        valueFrom:
          secretKeyRef:
            name: rails-secret-key-base
            key: SECRET_KEY_BASE
      - name: PUBLISHING_API_BEARER_TOKEN
        valueFrom:
          secretKeyRef:
            name: signon-token-license-finder-publishing-api
            key: bearer_token
            