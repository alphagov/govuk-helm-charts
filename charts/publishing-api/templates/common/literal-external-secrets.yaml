{{- range .Values.common.secrets.literalKeys }}
---
apiVersion: external-secrets.io/v1alpha1
kind: ExternalSecret
metadata:
  name: "{{ $.Release.Name }}-{{ . }}"
  labels:
    {{- include "publishing-api.labels" $ | nindent 4 }}
spec:
  refreshInterval: "{{ $.Values.common.secrets.externalSecretRefreshInterval }}"
  secretStoreRef:
    name: aws-secretsmanager
    kind: ClusterSecretStore
  target:
    name: "{{ $.Release.Name }}-{{ . }}"
  dataFrom:
    - key: "{{ $.Values.common.secrets.externalSecretRef | default (printf "govuk/%s/%s" $.Release.Namespace $.Release.Name) }}/{{ . }}"
{{- end }}
